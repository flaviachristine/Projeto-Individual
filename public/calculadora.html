<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/calculadora.css">
    <title>Stardew-Project</title>
</head>

<body>
    <header class="header">
        <a href="index.html" class="logo"><img src="./ASSETS/galinha.png" alt=""></a>
        <nav class="navbar">
            <a href="home.html">Home</a>
            <a href="dev.html">Desenvolvedora</a>
            <a href="quiz.html">Quiz</a>
            <a href="calculadora.html">Calculadora</a>
            <a href="dashboard.html" class="dash">Dashboard</a>
        </nav>
        <a href="index.html" class="logout"><img src="./ASSETS/Vector.svg" alt=""></a>
    </header>
    <div class="divLogoPrincipal">
        <div class="container">
            <div class="compra">
                <h1>Compra</h1><br>
                <label for="">Selecione uma estação:</label>
                <select name="" id="selectEstacaoCompra" onchange="trocaSelectCompra()">
                    <option value="primavera">Primavera</option>
                    <option value="verao">Verão</option>
                    <option value="outono">Outono</option>
                    <option value="inverno">Inverno</option>
                </select><br>
                <label for="">Selecione o produto</label>
                <select name="" id="selectFrutaCompra"></select><br>
                <label for="">Selecione a quantidade do produto</label>
                <input type="number" id="iptQtdCompra" placeholder="Quantidade"><br>
                <button onclick="adicionarCarrinho(selectFrutaCompra.value, iptQtdCompra.value)">Adicionar no Carrinho</button><br>
                <button onclick="comprar()">Comprar</button>
                <div class="pierre">
                    <img src="ASSETS/pierre.png" alt="">
                    <div class="falaPierre">
                        <img src="ASSETS/pierreFala.png" alt="" class="falaPierre">
                    </div>
                </div>
            </div>
            <div id="msg">
                <!-- <div id="carteira"></div> -->
            </div>
            <div class="container">
            <div class="venda">
                <h1>Venda</h1><br>
                <label for="">Selecione uma estação:</label>
                <select name="" id="selectEstacaoVenda" onchange="trocaSelectVenda()">
                    <option value="primavera">Primavera</option>
                    <option value="verao">Verão</option>
                    <option value="outono">Outono</option>
                    <option value="inverno">Inverno</option>
                </select><br>
                <label for="">Selecione o produto</label>
                <select name="" id="selectFrutaVenda"></select><br>
                <label for="">Selecione a quantidade do produto</label>
                <input type="number" id="iptQtdVenda" placeholder="Quantidade"><br>
                <div class="caixaRemessas">
                    <button class="caixa" onclick="adicionar(selectFrutaVenda.value, iptQtdVenda.value)">Adicionar na Caixa</button><br>
                    <button class="caixa" onclick="vender()">Vender</button><br>
                    <button class="caixa" onclick="remover(selectFruta.value, iptQtd.value)">Remover Último Produto</button><br>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
        © 2025 Flávia Hidalgo - Todos os direitos Reservados
    </footer>
</body>

</html>

<script>
    let caixa = [
        [], // Nome Horta
        [],  // Quantidade Horta
        [] // Preço de cada Horta
    ]
    let carrinho = [
        [],
        [],
        []
    ]
    let carteira = 500;
    msg.innerHTML = `Seu saldo na carteira: ${carteira}`;  

    function trocaSelectCompra() {

        let estacaoCompra = selectEstacaoCompra.value;
        

        if (estacaoCompra == 'primavera') {

            selectFrutaCompra.innerHTML = `<option value="chirivia">Chirivia</option>`
            selectFrutaCompra.innerHTML += `<option value="batata">Batata</option>`
            selectFrutaCompra.innerHTML += `<option value="morango">Morango</option>`
            selectFrutaCompra.innerHTML += `<option value="vagem">Vagem</option>`
            selectFrutaCompra.innerHTML += `<option value="couve-flor">Couve-Flor</option>`
            selectFrutaCompra.innerHTML += `<option value="couve">Couve</option>`
            selectFrutaCompra.innerHTML += `<option value="alho">Alho</option>`
            selectFrutaCompra.innerHTML += `<option value="arroz">Arroz não moído</option>`
            selectFrutaCompra.innerHTML += `<option value="cenoura">Cenoura</option>`
            selectFrutaCompra.innerHTML += `<option value="cafe">Grão de Café</option>`
            selectFrutaCompra.innerHTML += `<option value="jasmin">Jasmin-Azul</option>`
            selectFrutaCompra.innerHTML += `<option value="ruibarbo">Ruibarbo</option>`
            selectFrutaCompra.innerHTML += `<option value="tulipa">Tulipa</option>`

        } else if (estacaoCompra == 'verao') {

            selectFrutaCompra.innerHTML = `<option value="melao">Melão</option>`
            selectFrutaCompra.innerHTML += `<option value="mirtilo">Mirtilo</option>`
            selectFrutaCompra.innerHTML += `<option value="pimenta">Pimenta</option>`
            selectFrutaCompra.innerHTML += `<option value="abobrinha">Abobrinha de Verão</option>`
            selectFrutaCompra.innerHTML += `<option value="carambola">Carambola</option>`
            selectFrutaCompra.innerHTML += `<option value="micanga">Flor-Miçanga</option>`
            selectFrutaCompra.innerHTML += `<option value="girassol">Girassol</option>`
            selectFrutaCompra.innerHTML += `<option value="lupulo">Lúpulo</option>`
            selectFrutaCompra.innerHTML += `<option value="milho">Milho</option>`
            selectFrutaCompra.innerHTML += `<option value="papoula">Papoula</option>`
            selectFrutaCompra.innerHTML += `<option value="rabanete">Rabanete</option>`
            selectFrutaCompra.innerHTML += `<option value="repolho">Repolho Roxo</option>`
            selectFrutaCompra.innerHTML += `<option value="tomate">Tomate</option>`
            selectFrutaCompra.innerHTML += `<option value="trigo">Trigo</option>`

        } else if (estacaoCompra == 'outono') {

            selectFrutaCompra.innerHTML = `<option value="abobora">Abóbora</option>`
            selectFrutaCompra.innerHTML += `<option value="berinjela">Berinjela</option>`
            selectFrutaCompra.innerHTML += `<option value="alcachofra">Alcachofra</option>`
            selectFrutaCompra.innerHTML += `<option value="amaranto">Amaranto</option>`
            selectFrutaCompra.innerHTML += `<option value="beterraba">Beterraba</option>`
            selectFrutaCompra.innerHTML += `<option value="brocolis">Brócolis</option>`
            selectFrutaCompra.innerHTML += `<option value="couve-chinesa">Couve-Chinesa</option>`
            selectFrutaCompra.innerHTML += `<option value="inhame">Inhame</option>`
            selectFrutaCompra.innerHTML += `<option value="rosa-de-fada">Rosa-de-Fada</option>`
            selectFrutaCompra.innerHTML += `<option value="uva">Uva</option>`
            selectFrutaCompra.innerHTML += `<option value="oxicoco">Oxicoco</option>`


        } else if (estacaoCompra == 'inverno') {

            selectFrutaCompra.innerHTML = `<option value="melao-poeiro">Melão-Poeiro</option>`


        }
    }
    function trocaSelectVenda(){

        var estacaoVenda = selectEstacaoVenda.value;

        if (estacaoVenda == 'primavera') {

            selectFrutaVenda.innerHTML = `<option value="chirivia">Chirivia</option>`
            selectFrutaVenda.innerHTML += `<option value="batata">Batata</option>`
            selectFrutaVenda.innerHTML += `<option value="morango">Morango</option>`
            selectFrutaVenda.innerHTML += `<option value="vagem">Vagem</option>`
            selectFrutaVenda.innerHTML += `<option value="couve-flor">Couve-Flor</option>`
            selectFrutaVenda.innerHTML += `<option value="couve">Couve</option>`
            selectFrutaVenda.innerHTML += `<option value="alho">Alho</option>`
            selectFrutaVenda.innerHTML += `<option value="arroz">Arroz não moído</option>`
            selectFrutaVenda.innerHTML += `<option value="cenoura">Cenoura</option>`
            selectFrutaVenda.innerHTML += `<option value="cafe">Grão de Café</option>`
            selectFrutaVenda.innerHTML += `<option value="jasmin">Jasmin-Azul</option>`
            selectFrutaVenda.innerHTML += `<option value="ruibarbo">Ruibarbo</option>`
            selectFrutaVenda.innerHTML += `<option value="tulipa">Tulipa</option>`

        } else if (estacaoVenda == 'verao') {

            selectFrutaVenda.innerHTML = `<option value="melao">Melão</option>`
            selectFrutaVenda.innerHTML += `<option value="mirtilo">Mirtilo</option>`
            selectFrutaVenda.innerHTML += `<option value="pimenta">Pimenta</option>`
            selectFrutaVenda.innerHTML += `<option value="abobrinha">Abobrinha de Verão</option>`
            selectFrutaVenda.innerHTML += `<option value="carambola">Carambola</option>`
            selectFrutaVenda.innerHTML += `<option value="micanga">Flor-Miçanga</option>`
            selectFrutaVenda.innerHTML += `<option value="girassol">Girassol</option>`
            selectFrutaVenda.innerHTML += `<option value="lupulo">Lúpulo</option>`
            selectFrutaVenda.innerHTML += `<option value="milho">Milho</option>`
            selectFrutaVenda.innerHTML += `<option value="papoula">Papoula</option>`
            selectFrutaVenda.innerHTML += `<option value="rabanete">Rabanete</option>`
            selectFrutaVenda.innerHTML += `<option value="repolho">Repolho Roxo</option>`
            selectFrutaVenda.innerHTML += `<option value="tomate">Tomate</option>`
            selectFrutaVenda.innerHTML += `<option value="trigo">Trigo</option>`

        } else if (estacaoVenda == 'outono') {

            selectFrutaVenda.innerHTML = `<option value="abobora">Abóbora</option>`
            selectFrutaVenda.innerHTML += `<option value="berinjela">Berinjela</option>`
            selectFrutaVenda.innerHTML += `<option value="alcachofra">Alcachofra</option>`
            selectFrutaVenda.innerHTML += `<option value="amaranto">Amaranto</option>`
            selectFrutaVenda.innerHTML += `<option value="beterraba">Beterraba</option>`
            selectFrutaVenda.innerHTML += `<option value="brocolis">Brócolis</option>`
            selectFrutaVenda.innerHTML += `<option value="couve-chinesa">Couve-Chinesa</option>`
            selectFrutaVenda.innerHTML += `<option value="inhame">Inhame</option>`
            selectFrutaVenda.innerHTML += `<option value="rosa-de-fada">Rosa-de-Fada</option>`
            selectFrutaVenda.innerHTML += `<option value="uva">Uva</option>`
            selectFrutaVenda.innerHTML += `<option value="oxicoco">Oxicoco</option>`


        } else if (estacaoVenda == 'inverno') {

            selectFrutaVenda.innerHTML = `<option value="melao-poeiro">Melão-Poeiro</option>`


        }
    }

    function adicionar(horta, qtd) {

        var quantidade = Number(qtd);

        if(quantidade == ''){
            msg.innerHTML += `Preencha todos os campos para prosseguir`
        } 

        if (caixa[0].includes(horta)) {

            caixa[1][caixa[0].indexOf(horta)] += quantidade;
        } else {
            caixa[0].push(horta)
            caixa[1].push(quantidade)

            if (horta == 'alho') {
                caixa[2].push(quantidade * 60)
            } else if(horta == 'arroz'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'batata'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'cenoura'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'chirivia'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'couve'){
                caixa[2].push(quantidade * 110)
            }else if(horta == 'couve-flor'){
                caixa[2].push(quantidade * 175)
            }else if(horta == 'cafe'){
                caixa[2].push(quantidade * 15)
            }else if(horta == 'jasmin'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'morango'){
                caixa[2].push(quantidade * 120)
            }else if(horta == 'ruibabo'){
                caixa[2].push(quantidade * 220)
            }else if(horta == 'tulipa'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'vagem'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'abobrinha'){
                caixa[2].push(quantidade * 45)
            }else if(horta == 'carambola'){
                caixa[2].push(quantidade * 750)
            }else if(horta == 'micanga'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'girassol'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'lupulo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'melao'){
                caixa[2].push(quantidade * 250)
            }else if(horta == 'mirtilo'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'papoula'){
                caixa[2].push(quantidade * 140)
            }else if(horta == 'pimenta'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'rabanete'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'repolho'){
                caixa[2].push(quantidade * 260)
            }else if(horta == 'tomate'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'trigo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'abobora'){
                caixa[2].push(quantidade * 320)
            }else if(horta == 'alcachofra'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'amaranto'){
                caixa[2].push(quantidade * 150)
            }else if(horta == 'berinjela'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'beterraba'){
                caixa[2].push(quantidade * 100)
            }else if(horta == 'brocolis'){
                caixa[2].push(quantidade * 70)
            }else if(horta == 'couve-chinesa'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'inhame'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'oxicoco'){
                caixa[2].push(quantidade * 75)
            }else if(horta == 'rosa-de-fada'){
                caixa[2].push(quantidade * 290)
            }else if(horta == 'uva'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'melao-poeiro'){
                caixa[2].push(quantidade * 60)
            }
        }
            msg.innerHTML = `Produto ${horta} adicionado com sucesso <br>`


    }
    function adicionarCarrinho(horta, qtd) {

        var quantidade = Number(qtd);

        if(quantidade == ''){
            msg.innerHTML = `Preencha todos os campos para prosseguir`
        } 

        if (carrinho[0].includes(horta)) {

            carrinho[1][carrinho[0].indexOf(horta)] += quantidade;
        } else {
            carrinho[0].push(horta)
            carrinho[1].push(quantidade)

            if (horta == 'alho') {
                carrinho[2].push(quantidade * 60)
            } else if(horta == 'arroz'){
                carrinho[2].push(quantidade * 30)
            }else if(horta == 'batata'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'cenoura'){
                carrinho[2].push(quantidade * 35)
            }else if(horta == 'chirivia'){
                carrinho[2].push(quantidade * 35)
            }else if(horta == 'couve'){
                carrinho[2].push(quantidade * 110)
            }else if(horta == 'couve-flor'){
                carrinho[2].push(quantidade * 175)
            }else if(horta == 'cafe'){
                carrinho[2].push(quantidade * 15)
            }else if(horta == 'jasmin'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'morango'){
                carrinho[2].push(quantidade * 120)
            }else if(horta == 'ruibabo'){
                carrinho[2].push(quantidade * 220)
            }else if(horta == 'tulipa'){
                carrinho[2].push(quantidade * 30)
            }else if(horta == 'vagem'){
                carrinho[2].push(quantidade * 40)
            }else if(horta == 'abobrinha'){
                carrinho[2].push(quantidade * 45)
            }else if(horta == 'carambola'){
                carrinho[2].push(quantidade * 750)
            }else if(horta == 'micanga'){
                carrinho[2].push(quantidade * 90)
            }else if(horta == 'girassol'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'lupulo'){
                carrinho[2].push(quantidade * 25)
            }else if(horta == 'melao'){
                carrinho[2].push(quantidade * 250)
            }else if(horta == 'mirtilo'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'papoula'){
                carrinho[2].push(quantidade * 140)
            }else if(horta == 'pimenta'){
                carrinho[2].push(quantidade * 40)
            }else if(horta == 'rabanete'){
                carrinho[2].push(quantidade * 90)
            }else if(horta == 'repolho'){
                carrinho[2].push(quantidade * 260)
            }else if(horta == 'tomate'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'trigo'){
                carrinho[2].push(quantidade * 25)
            }else if(horta == 'abobora'){
                carrinho[2].push(quantidade * 320)
            }else if(horta == 'alcachofra'){
                carrinho[2].push(quantidade * 160)
            }else if(horta == 'amaranto'){
                carrinho[2].push(quantidade * 150)
            }else if(horta == 'berinjela'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'beterraba'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'brocolis'){
                carrinho[2].push(quantidade * 70)
            }else if(horta == 'couve-chinesa'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'inhame'){
                carrinho[2].push(quantidade * 160)
            }else if(horta == 'oxicoco'){
                carrinho[2].push(quantidade * 75)
            }else if(horta == 'rosa-de-fada'){
                carrinho[2].push(quantidade * 290)
            }else if(horta == 'uva'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'melao-poeiro'){
                carrinho[2].push(quantidade * 60)
            }
        }
            msg.innerHTML = `Produto ${horta} adicionado com sucesso no carrinho <br>`


    }

    function remover() {
        var remover = inputDeletar.value

        if (caixa[0].includes(remover)) {
            while (caixa[0].includes(remover)) {
                caixa[1].splice(caixa[0].indexOf(remover), 1)
                caixa[1].splice(caixa[1].indexOf(remover), 1)
            }
            msg.innerHTML = `O produto ${remover} foi removido da caixa`
        } else {
            msg.innerHTML = `O produto ${remover} não foi vendido hoje`
        }
    }
    function vender() {

        // for(var i= 0; i < caixa.length; i++){

        fetch("/venda/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuarioServer: sessionStorage.ID_USUARIO,
                produtoServer: caixa[0][0],
                qtdServer: caixa[1][0],
                precoServer: caixa[2][0]
            }), 
        })
        msg.innerHTML = `Produto ${caixa[0][caixa[0].length - 1]} Vendido com sucesso, você vendeu ${caixa[1][caixa[1].length - 1]} unidades, pelo preço de ${caixa[2][caixa[2].length - 1]} 🪙! <br>`
        carteira += caixa[2][0]
        caixa = [[], [], []]
    }
    function comprar() {

        // for(var i= 0; i < caixa.length; i++){

        // fetch("/venda/cadastrar", {
        //     method: "POST",
        //     headers: {
        //         "Content-Type": "application/json",
        //     },
        //     body: JSON.stringify({
        //         idUsuarioServer: sessionStorage.ID_USUARIO,
        //         produtoServer: caixa[0][0],
        //         qtdServer: caixa[1][0],
        //         precoServer: caixa[2][0]
        //     }), 
        // })
        msg.innerHTML = `Produto ${carrinho[0][carrinho[0].length - 1]} comprado com sucesso, você comprou ${carrinho[1][carrinho[1].length - 1]} unidades, pelo preço de ${carrinho[2][carrinho[2].length - 1]} 🪙! <br>`
        carteira -= carrinho[2][0]
        carrinho = [[], [], []]
    }
    // }

</script>