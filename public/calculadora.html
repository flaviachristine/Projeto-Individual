<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/calculadora.css">
    <title>Stardew-Project</title>
</head>

<body>
    <header class="header">
        <a href="index.html" class="logo"><img src="./ASSETS/galinha.png" alt=""></a>
        <nav class="navbar">
            <a href="home.html">Home</a>
            <a href="dev.html">Desenvolvedora</a>
            <a href="quiz.html">Quiz</a>
            <a href="calculadora.html">Calculadora</a>
            <a href="dashboard.html" class="dash">Dashboard</a>
        </nav>
        <a href="index.html" class="logout"><img src="./ASSETS/Vector.svg" alt=""></a>
    </header>
    <div class="divLogoPrincipal">
        <div class="container">
            <h1>Calculadora</h1><br>
            <label for="">Selecione uma estação:</label>
            <select name="" id="selectEstacao" onchange="trocaSelect()">
                <option value="primavera">Primavera</option>
                <option value="verao">Verão</option>
                <option value="outono">Outono</option>
                <option value="inverno">Inverno</option>
            </select><br>
            <label for="">Selecione o produto</label>
            <select name="" id="selectFruta"></select><br>
            <label for="">Selecione a quantidade do produto</label>
            <input type="number" id="iptQtd" placeholder="Quantidade"><br>


            <button onclick="adicionar(selectFruta.value, iptQtd.value)">Adicionar na Caixa</button><br>
            <button onclick="vender()">Vender</button><br>
            Produto a ser removido da caixa
            <input type="text" id="inputDeletar"><br>
            <button onclick="remover(selectFruta.value, iptQtd.value)">Remover Produto</button><br>
            <div id="msg"></div>

            


        </div>
    </div>
    <footer class="footer">
        © 2025 Flávia Hidalgo - Todos os direitos Reservados
    </footer>
</body>

</html>

<script>
    var caixa = [
        [], // Nome Horta
        [],  // Quantidade Horta
        [] // Preço de cada Horta
    ]

    function trocaSelect() {

        var estacao = selectEstacao.value;

        if (estacao == 'primavera') {

            selectFruta.innerHTML = `<option value="chirivia">Chirivia</option>`
            selectFruta.innerHTML += `<option value="batata">Batata</option>`
            selectFruta.innerHTML += `<option value="morango">Morango</option>`
            selectFruta.innerHTML += `<option value="vagem">Vagem</option>`
            selectFruta.innerHTML += `<option value="couve-flor">Couve-Flor</option>`
            selectFruta.innerHTML += `<option value="couve">Couve</option>`
            selectFruta.innerHTML += `<option value="alho">Alho</option>`
            selectFruta.innerHTML += `<option value="arroz">Arroz não moído</option>`
            selectFruta.innerHTML += `<option value="cenoura">Cenoura</option>`
            selectFruta.innerHTML += `<option value="cafe">Grão de Café</option>`
            selectFruta.innerHTML += `<option value="jasmin">Jasmin-Azul</option>`
            selectFruta.innerHTML += `<option value="ruibarbo">Ruibarbo</option>`
            selectFruta.innerHTML += `<option value="tulipa">Tulipa</option>`

        } else if (estacao == 'verao') {

            selectFruta.innerHTML = `<option value="melao">Melão</option>`
            selectFruta.innerHTML += `<option value="mirtilo">Mirtilo</option>`
            selectFruta.innerHTML += `<option value="pimenta">Pimenta</option>`
            selectFruta.innerHTML += `<option value="abobrinha">Abobrinha de Verão</option>`
            selectFruta.innerHTML += `<option value="carambola">Carambola</option>`
            selectFruta.innerHTML += `<option value="micanga">Flor-Miçanga</option>`
            selectFruta.innerHTML += `<option value="girassol">Girassol</option>`
            selectFruta.innerHTML += `<option value="lupulo">Lúpulo</option>`
            selectFruta.innerHTML += `<option value="milho">Milho</option>`
            selectFruta.innerHTML += `<option value="papoula">Papoula</option>`
            selectFruta.innerHTML += `<option value="rabanete">Rabanete</option>`
            selectFruta.innerHTML += `<option value="repolho">Repolho Roxo</option>`
            selectFruta.innerHTML += `<option value="tomate">Tomate</option>`
            selectFruta.innerHTML += `<option value="trigo">Trigo</option>`

        } else if (estacao == 'outono') {

            selectFruta.innerHTML = `<option value="abobora">Abóbora</option>`
            selectFruta.innerHTML += `<option value="berinjela">Berinjela</option>`
            selectFruta.innerHTML += `<option value="alcachofra">Alcachofra</option>`
            selectFruta.innerHTML += `<option value="amaranto">Amaranto</option>`
            selectFruta.innerHTML += `<option value="beterraba">Beterraba</option>`
            selectFruta.innerHTML += `<option value="brocolis">Brócolis</option>`
            selectFruta.innerHTML += `<option value="couve-chinesa">Couve-Chinesa</option>`
            selectFruta.innerHTML += `<option value="inhame">Inhame</option>`
            selectFruta.innerHTML += `<option value="rosa-de-fada">Rosa-de-Fada</option>`
            selectFruta.innerHTML += `<option value="uva">Uva</option>`
            selectFruta.innerHTML += `<option value="oxicoco">Oxicoco</option>`


        } else if (estacao == 'inverno') {

            selectFruta.innerHTML = `<option value="melao-poeiro">Melão-Poeiro</option>`


        }

    }

    function adicionar(horta, qtd) {

        var quantidade = Number(qtd);

        if(quantidade == ''){
            msg.innerHTML = `Preencha todos os campos para prosseguir`
        } 

        if (caixa[0].includes(horta)) {

            caixa[1][caixa[0].indexOf(horta)] += quantidade;
        } else {
            caixa[0].push(horta)
            caixa[1].push(quantidade)

            if (horta == 'alho') {
                caixa[2].push(quantidade * 60)
            } else if(horta == 'arroz'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'batata'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'cenoura'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'chirivia'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'couve'){
                caixa[2].push(quantidade * 110)
            }else if(horta == 'couve-flor'){
                caixa[2].push(quantidade * 175)
            }else if(horta == 'cafe'){
                caixa[2].push(quantidade * 15)
            }else if(horta == 'jasmin'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'morango'){
                caixa[2].push(quantidade * 120)
            }else if(horta == 'ruibabo'){
                caixa[2].push(quantidade * 220)
            }else if(horta == 'tulipa'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'vagem'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'abobrinha'){
                caixa[2].push(quantidade * 45)
            }else if(horta == 'carambola'){
                caixa[2].push(quantidade * 750)
            }else if(horta == 'micanga'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'girassol'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'lupulo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'melao'){
                caixa[2].push(quantidade * 250)
            }else if(horta == 'mirtilo'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'papoula'){
                caixa[2].push(quantidade * 140)
            }else if(horta == 'pimenta'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'rabanete'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'repolho'){
                caixa[2].push(quantidade * 260)
            }else if(horta == 'tomate'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'trigo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'abobora'){
                caixa[2].push(quantidade * 320)
            }else if(horta == 'alcachofra'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'amaranto'){
                caixa[2].push(quantidade * 150)
            }else if(horta == 'berinjela'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'beterraba'){
                caixa[2].push(quantidade * 100)
            }else if(horta == 'brocolis'){
                caixa[2].push(quantidade * 70)
            }else if(horta == 'couve-chinesa'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'inhame'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'oxicoco'){
                caixa[2].push(quantidade * 75)
            }else if(horta == 'rosa-de-fada'){
                caixa[2].push(quantidade * 290)
            }else if(horta == 'uva'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'melao-poeiro'){
                caixa[2].push(quantidade * 60)
            }
        }

            msg.innerHTML = `Produto ${horta} adicionado com sucesso`


    }

    function remover() {
        var remover = inputDeletar.value

        if (caixa[0].includes(remover)) {
            while (caixa[0].includes(remover)) {
                caixa[1].splice(caixa[0].indexOf(remover), 1)
                caixa[1].splice(caixa[1].indexOf(remover), 1)
            }
            msg.innerHTML = `O produto ${remover} foi removido da caixa`
        } else {
            msg.innerHTML = `O produto ${remover} não foi vendido hoje`
        }
    }
    function vender() {

        // for(var i= 0; i < caixa.length; i++){

        fetch("/venda/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuarioServer: sessionStorage.ID_USUARIO,
                produtoServer: caixa[0][0],
                qtdServer: caixa[1][0],
                precoServer: caixa[2][0]
            }),
        })
        msg.innerHTML = `Produto ${caixa[0][caixa[0].length - 1]} Vendido com sucesso, você vendeu ${caixa[1][caixa[1].length - 1]} unidades, pelo preço de ${caixa[2][caixa[2].length - 1]} 🪙!`
        caixa = [[], [], []]
    }
    // }

</script>