<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/calculadora.css">
    <title>Stardew-Project</title>
</head>

<body>
    <header class="header">
        <a href="index.html" class="logo"><img src="./ASSETS/galinha.png" alt=""></a>
        <nav class="navbar">
            <a href="home.html">Home</a>
            <a href="dev.html">Desenvolvedora</a>
            <a href="quiz.html">Quiz</a>
            <a href="calculadora.html">Calculadora</a>
            <a href="dashboard.html" class="dash">Dashboard</a>
        </nav>
        <a href="index.html" class="logout"><img src="./ASSETS/Vector.svg" alt=""></a>
    </header>
    <div class="divLogoPrincipal">
        <div class="container">
            <div class="compra">
                <h1>Compra</h1><br>
                <label for="">Selecione uma estaÃ§Ã£o:</label>
                <select name="" id="selectEstacaoCompra" onchange="trocaSelectCompra()">
                    <option value="primavera">Primavera</option>
                    <option value="verao">VerÃ£o</option>
                    <option value="outono">Outono</option>
                    <option value="inverno">Inverno</option>
                </select><br>
                <label for="">Selecione o produto</label>
                <select name="" id="selectFrutaCompra"></select><br>
                <label for="">Selecione a quantidade do produto</label>
                <input type="number" id="iptQtdCompra" placeholder="Quantidade"><br>
                <button onclick="adicionarCarrinho(selectFrutaCompra.value, iptQtdCompra.value)">Adicionar no Carrinho</button><br>
                <button onclick="comprar()">Comprar</button>
                <div class="pierre">
                    <img src="ASSETS/pierre.png" alt="">
                    <div class="falaPierre">
                        <img src="ASSETS/pierreFala.png" alt="" class="falaPierre">
                    </div>
                </div>
            </div>
            <div id="Mensagens">
                
                <div id="msg" class="msg1"></div>
                <div id="msgVenda" class="msg"></div>
                <div id="msgCompra" class="msg"></div>
            </div>
            
            <div class="container">
            <div class="venda">
                <h1>Venda</h1><br>
                <label for="">Selecione uma estaÃ§Ã£o:</label>
                <select name="" id="selectEstacaoVenda" onchange="trocaSelectVenda()">
                    <option value="primavera">Primavera</option>
                    <option value="verao">VerÃ£o</option>
                    <option value="outono">Outono</option>
                    <option value="inverno">Inverno</option>
                </select><br>
                <label for="">Selecione o produto</label>
                <select name="" id="selectFrutaVenda"></select><br>
                <label for="">Selecione a quantidade do produto</label>
                <input type="number" id="iptQtdVenda" placeholder="Quantidade"><br>
                <div class="caixaRemessas">
                    <button class="caixa" onclick="adicionar(selectFrutaVenda.value, iptQtdVenda.value)">Adicionar na Caixa</button><br>
                    <button class="caixa" onclick="vender()">Vender</button><br>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
        Â© 2025 FlÃ¡via Hidalgo - Todos os direitos Reservados
    </footer>
</body>

</html>

<script>
    let carteira
    
    fetch("/usuarios/carteira", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            idUsuarioServer: sessionStorage.ID_USUARIO
        })
    }).then(function (resposta) {
        console.log("ESTOU NO THEN DO entrar()!")


        if (resposta.ok) {
            console.log(resposta);

            resposta.json().then(json => {
                console.log(json);
                console.log(JSON.stringify(json));
                carteira = json[0]['carteira']
                msg.innerHTML = `Seu saldo na carteira: ${carteira}ðŸª™<br><br>`; 
                
            });
        }
    }).catch(function (erro) {
        console.log(erro);
    })
    // matriz caixa, que guarda o nome da horta, sua quantidade e seu preÃ§o
    let caixa = [
        [], // Nome Horta
        [],  // Quantidade Horta
        [] // PreÃ§o de cada Horta
    ]
    // matriz carrinho, que guarda o nome da horta, sua quantidade e seu preÃ§o
    let carrinho = [
        [],
        [],
        []
    ]
     
    function trocaSelectCompra() {
        // esta funcao serve para que ao selecionar a estaÃ§Ã£o, sejam habilitadas as hortas da respectiva estaÃ§Ã£o
        let estacaoCompra = selectEstacaoCompra.value;
        

        if (estacaoCompra == 'primavera') {

            selectFrutaCompra.innerHTML = `<option value="Chirivia">Chirivia 20ðŸª™ </option>`
            selectFrutaCompra.innerHTML += `<option value="Batata">Batata 62ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Morango">Morango 100ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Vagem">Vagem 60ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Couve-Flor">Couve-Flor 80ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Couve">Couve 70ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Alho">Alho 40ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Arroz">Arroz 40ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Cenoura">Cenoura 10ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="CafÃ©">CafÃ© 15ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Jasmin-Azul">Jasmin-Azul 30ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Ruibarbo">Ruibarbo 100ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Tulipa">Tulipa 20ðŸª™</option>`

        } else if (estacaoCompra == 'verao') {

            selectFrutaCompra.innerHTML = `<option value="MelÃ£o">MelÃ£o 80ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Mirtilo">Mirtilo 80ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Pimenta">Pimenta 40ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Abobrinha">Abobrinha 10ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Carambola">Carambola 400ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Flor-MiÃ§anga">Flor-MiÃ§anga 50ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Girassol">Girassol 200ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="LÃºpulo">LÃºpulo 60ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Milho">Milho 150ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Papoula">Papoula 100ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Rabanete">Rabanete 40ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Repolho Roxo">Repolho Roxo 100ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Tomate">Tomate 50ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Trigo">Trigo 10ðŸª™</option>`

        } else if (estacaoCompra == 'outono') {

            selectFrutaCompra.innerHTML = `<option value="AbÃ³bora">AbÃ³bora 100ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Berinjela">Berinjela 20ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Alcachofra">Alcachofra 30ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Amaranto">Amaranto 70ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Beterraba">Beterraba 20ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="BrÃ³colis">BrÃ³colis 10ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Couve-Chinesa">Couve-Chinesa 50ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Inhame">Inhame 60ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Rosa-de-Fada">Rosa-de-Fada 200ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Uva">Uva 60ðŸª™</option>`
            selectFrutaCompra.innerHTML += `<option value="Oxicoco">Oxicoco 240ðŸª™</option>`


        } else if (estacaoCompra == 'inverno') {

            selectFrutaCompra.innerHTML = `<option value="MelÃ£o-Poeiro">MelÃ£o-Poeiro 10ðŸª™</option>`


        }
    }
    function trocaSelectVenda(){
        // esta funcao serve para que ao selecionar a estaÃ§Ã£o, sejam habilitadas as hortas da respectiva estaÃ§Ã£o
        var estacaoVenda = selectEstacaoVenda.value;

        if (estacaoVenda == 'primavera') {

            selectFrutaVenda.innerHTML = `<option value="Chirivia">Chirivia 35ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Batata">Batata 80ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Morango">Morango 120ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Vagem">Vagem 40ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Couve-Flor">Couve-Flor 175ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Couve">Couve 110ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Alho">Alho 60ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Arroz">Arroz 30ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Cenoura">Cenoura 10ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="CafÃ©">CafÃ© 15ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Jasmin-Azul">Jasmin-Azul 50ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Ruibarbo">Ruibarbo 220ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Tulipa">Tulipa 30ðŸª™</option>`

        } else if (estacaoVenda == 'verao') {

            selectFrutaVenda.innerHTML = `<option value="MelÃ£o">MelÃ£o 250ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Mirtilo">Mirtilo 50ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Pimenta">Pimenta 40ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Abobrinha">Abobrinha 10ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Carambola">Carambola 750ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Flor-MiÃ§anga">Flor-MiÃ§anga 90ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Girassol">Girassol 80ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="LÃºpulo">LÃºpulo 25ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Milho">Milho 50ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Papoula">Papoula 140ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Rabanete">Rabanete 90ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Repolho-Roxo">Repolho-Roxo 260ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Tomate">Tomate 60ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Trigo">Trigo 25ðŸª™</option>`

        } else if (estacaoVenda == 'outono') {

            selectFrutaVenda.innerHTML = `<option value="AbÃ³bora">AbÃ³bora 320ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Berinjela">Berinjela 60ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Alcachofra">Alcachofra 160ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Amaranto">Amaranto 150ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Beterraba">Beterraba 100ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="BrÃ³colis">BrÃ³colis 70ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Couve-Chinesa">Couve-Chinesa 80ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Inhame">Inhame 160ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Rosa-de-Fada">Rosa-de-Fada 290ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Uva">Uva 80ðŸª™</option>`
            selectFrutaVenda.innerHTML += `<option value="Oxicoco">Oxicoco 75ðŸª™</option>`


        } else if (estacaoVenda == 'inverno') {

            selectFrutaVenda.innerHTML = `<option value="MelÃ£o-Poeiro">MelÃ£o-Poeiro 10ðŸª™</option>`


        }
    }

    function adicionar(horta, qtd) {
        // usando parametros, trazemos a horta e a quantidade
        var quantidade = Number(qtd);

        if(quantidade == ''){
            msg.innerHTML += `Preencha todos os campos para prosseguir<br><br>`
        } 
        // aqui Ã© onde definimos que se o produto ja existe na caixa, ele Ã© apenas incrementado na quantidade
        if (caixa[0].includes(horta)) {

            caixa[1][caixa[0].indexOf(horta)] += quantidade;
        } else {
            caixa[0].push(horta)
            caixa[1].push(quantidade)
            // aqui Ã© definido o preÃ§o de venda de cada hortaliÃ§a, definindo seu preÃ§o na matriz caixa na posiÃ§Ã£o 2, que Ã© o preÃ§o da hortaliÃ§a, quantidade referencia pelo input preenchido pelo usuÃ¡rio
            if (horta == 'Alho') {
                caixa[2].push(quantidade * 60)
            } else if(horta == 'Arroz'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'Batata'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'Cenoura'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'Chirivia'){
                caixa[2].push(quantidade * 35)
            }else if(horta == 'Couve'){
                caixa[2].push(quantidade * 110)
            }else if(horta == 'Couve-flor'){
                caixa[2].push(quantidade * 175)
            }else if(horta == 'CafÃ©'){
                caixa[2].push(quantidade * 15)
            }else if(horta == 'Jasmin-Azul'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'Morango'){
                caixa[2].push(quantidade * 120)
            }else if(horta == 'Ruibabo'){
                caixa[2].push(quantidade * 220)
            }else if(horta == 'Tulipa'){
                caixa[2].push(quantidade * 30)
            }else if(horta == 'Vagem'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'Abobrinha'){
                caixa[2].push(quantidade * 45)
            }else if(horta == 'Carambola'){
                caixa[2].push(quantidade * 750)
            }else if(horta == 'Flor-MiÃ§anga'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'Girassol'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'LÃºpulo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'MelÃ£o'){
                caixa[2].push(quantidade * 250)
            }else if(horta == 'Mirtilo'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'Milho'){
                caixa[2].push(quantidade * 50)
            }else if(horta == 'Papoula'){
                caixa[2].push(quantidade * 140)
            }else if(horta == 'Pimenta'){
                caixa[2].push(quantidade * 40)
            }else if(horta == 'Rabanete'){
                caixa[2].push(quantidade * 90)
            }else if(horta == 'Repolho-Roxo'){
                caixa[2].push(quantidade * 260)
            }else if(horta == 'Tomate'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'Trigo'){
                caixa[2].push(quantidade * 25)
            }else if(horta == 'AbÃ³bora'){
                caixa[2].push(quantidade * 320)
            }else if(horta == 'Alcachofra'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'Amaranto'){
                caixa[2].push(quantidade * 150)
            }else if(horta == 'Berinjela'){
                caixa[2].push(quantidade * 60)
            }else if(horta == 'Beterraba'){
                caixa[2].push(quantidade * 100)
            }else if(horta == 'BrÃ³colis'){
                caixa[2].push(quantidade * 70)
            }else if(horta == 'Couve-chinesa'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'Inhame'){
                caixa[2].push(quantidade * 160)
            }else if(horta == 'Oxicoco'){
                caixa[2].push(quantidade * 75)
            }else if(horta == 'Rosa-de-Fada'){
                caixa[2].push(quantidade * 290)
            }else if(horta == 'Uva'){
                caixa[2].push(quantidade * 80)
            }else if(horta == 'MelÃ£o-poeiro'){
                caixa[2].push(quantidade * 60)
            }
        }
            msgVenda.innerHTML = `Produto ${horta} adicionado com sucesso <br><br>`


    }
    function adicionarCarrinho(horta, qtd) {
        // usando parametros, trazemos a horta e a quantidade
        var quantidade = Number(qtd);

        if(quantidade == ''){
            msg.innerHTML += `Preencha todos os campos para prosseguir<br><br>`
        } 
        // aqui Ã© onde definimos que se o produto ja existe na caixa, ele Ã© apenas incrementado na quantidade
        if (carrinho[0].includes(horta)) {

            carrinho[1][carrinho[0].indexOf(horta)] += quantidade;
        } else {
            carrinho[0].push(horta)
            carrinho[1].push(quantidade)
            // aqui Ã© definido o preÃ§o de compra de cada hortaliÃ§a, definindo seu preÃ§o na matriz caixa na posiÃ§Ã£o 2, que Ã© o preÃ§o da hortaliÃ§a, quantidade referencia pelo input preenchido pelo usuÃ¡rio
            if (horta == 'Alho') {
                carrinho[2].push(quantidade * 40)
            } else if(horta == 'Arroz'){
                carrinho[2].push(quantidade * 40)
            }else if(horta == 'Batata'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'Cenoura'){
                carrinho[2].push(quantidade * 10)
            }else if(horta == 'Chirivia'){
                carrinho[2].push(quantidade * 20)
            }else if(horta == 'Couve'){
                carrinho[2].push(quantidade * 70)
            }else if(horta == 'Couve-flor'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'CafÃ©'){
                carrinho[2].push(quantidade * 10)
            }else if(horta == 'Jasmin-Azul'){
                carrinho[2].push(quantidade * 30)
            }else if(horta == 'Morango'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'Ruibabo'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'Tulipa'){
                carrinho[2].push(quantidade * 20)
            }else if(horta == 'Vagem'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'Abobrinha'){
                carrinho[2].push(quantidade * 10)
            }else if(horta == 'Carambola'){
                carrinho[2].push(quantidade * 400)
            }else if(horta == 'Flor-MiÃ§anga'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'Girassol'){
                carrinho[2].push(quantidade * 200)
            }else if(horta == 'LÃºpulo'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'MelÃ£o'){
                carrinho[2].push(quantidade * 80)
            }else if(horta == 'Mirtilo'){
                carrinho[2].push(quantidade * 150)
            }else if(horta == 'Milho'){
                carrinho[2].push(quantidade * 150)
            }else if(horta == 'Papoula'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'Pimenta'){
                carrinho[2].push(quantidade * 40)
            }else if(horta == 'Rabanete'){
                carrinho[2].push(quantidade * 40)
            }else if(horta == 'Repolho-Roxo'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'Tomate'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'Trigo'){
                carrinho[2].push(quantidade * 10)
            }else if(horta == 'AbÃ³bora'){
                carrinho[2].push(quantidade * 100)
            }else if(horta == 'Alcachofra'){
                carrinho[2].push(quantidade * 30)
            }else if(horta == 'Amaranto'){
                carrinho[2].push(quantidade * 70)
            }else if(horta == 'Berinjela'){
                carrinho[2].push(quantidade * 20)
            }else if(horta == 'Beterraba'){
                carrinho[2].push(quantidade * 20)
            }else if(horta == 'BrÃ³colis'){
                carrinho[2].push(quantidade * 10)
            }else if(horta == 'Couve-chinesa'){
                carrinho[2].push(quantidade * 50)
            }else if(horta == 'Inhame'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'Oxicoco'){
                carrinho[2].push(quantidade * 240)
            }else if(horta == 'Rosa-de-Fada'){
                carrinho[2].push(quantidade * 200)
            }else if(horta == 'Uva'){
                carrinho[2].push(quantidade * 60)
            }else if(horta == 'MelÃ£o-poeiro'){
                carrinho[2].push(quantidade * 10)
            }
        }
            msgCompra.innerHTML = `Produto ${horta} adicionado com sucesso no carrinho <br><br>`
    }
    function vender() {

        fetch("/venda/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // aqui na api, definimos que o produto, qtd e preÃ§o sÃ£o tais posiÃ§Ãµes na matriz
                idUsuarioServer: sessionStorage.ID_USUARIO,
                produtoServer: caixa[0][0],
                qtdServer: caixa[1][0],
                precoServer: caixa[2][0]
            }), 
        })
        msgVenda.innerHTML = `Produto ${caixa[0][caixa[0].length - 1]} Vendido com sucesso, vocÃª vendeu ${caixa[1][caixa[1].length - 1]} unidades, pelo preÃ§o de ${caixa[2][caixa[2].length - 1]} ðŸª™! <br><br>`
        

        fetch("/usuarios/attCarteira", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // este fetch serve para atualizar o valor da carteira, conforme o usuÃ¡rio vende produtos
                idUsuarioServer: sessionStorage.ID_USUARIO,
                valorAtualizadoServer: carteira += caixa[2][0]
            }), 
        })

        fetch("/usuarios/valorCarteiraAtualizado", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // este fetch serve para guardar o histÃ³rico da carteira para futuramente ser puxado no grÃ¡fico na dashboard
                idUsuarioServer: sessionStorage.ID_USUARIO,
                valorAtualizadoServer: carteira
            }), 
        })
        // zerando a matriz
        caixa = [[], [], []]
        
        msg.innerHTML = `Seu saldo na carteira: ${carteira}ðŸª™`
    }
    function comprar() {

         fetch("/compra/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // aqui na api, definimos que o produto, qtd e preÃ§o sÃ£o tais posiÃ§Ãµes na matriz
                idUsuarioServer: sessionStorage.ID_USUARIO,
                produtoServer: carrinho[0][0],
                qtdServer: carrinho[1][0],
                precoServer: carrinho[2][0]
            }), 
        })
        msgCompra.innerHTML = `Produto ${carrinho[0][carrinho[0].length - 1]} comprado com sucesso, vocÃª comprou ${carrinho[1][carrinho[1].length - 1]} unidades, pelo preÃ§o de ${carrinho[2][carrinho[2].length - 1]} ðŸª™! <br><br>`


        fetch("/usuarios/attCarteira", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // este fetch serve para atualizar o valor da carteira, conforme o usuÃ¡rio vende produtos
                idUsuarioServer: sessionStorage.ID_USUARIO,
                valorAtualizadoServer: carteira -= carrinho[2][0]
            }), 
        })

        fetch("/usuarios/valorCarteiraAtualizado", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // este fetch serve para guardar o histÃ³rico da carteira para futuramente ser puxado no grÃ¡fico na dashboard
                idUsuarioServer: sessionStorage.ID_USUARIO,
                valorAtualizadoServer: carteira
            }), 
        })
        // zerando a matriz
        carrinho = [[], [], []]
        msg.innerHTML = `Seu saldo na carteira: ${carteira}ðŸª™`
    }
</script>